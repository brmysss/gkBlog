---
title: 条件概率、全概率与贝叶斯公式 —— 一篇文章带你死磕概率公式
description: "‌概率公式是概率论中的核心工具，主要包括加法公式、乘法公式、条件概率公式、全概率公式、贝叶斯公式和独立事件公式等‌。这些公式用于计算不同情境下事件发生的概率，涵盖从基本事件到复杂事件的概率计算需求。"
date: "2025-05-29"
lang: zh
tags:
  - 统计与概率
  - 数学
  - 高考
category: 技术笔记
cover: https://cdn.qladgk.com/images/20250529174616716.png
---

import Image from "@/components/mdx/Image";
import Draft from "@/components/mdx/Draft";

<Image
  src="https://cdn.qladgk.com/images/20250529174616716.png"
  alt="cover"
  width={999}
  height={527}
  isArticleImage={true}
/>

## 什么是概率

概率是一个介于 0 和 1 之间的数，表示一个事件发生的可能性。

### 计算方法

所有的概率都只可以用一个公式来表示，即概率的古典定义：$$P(A) = \frac{n(A)}{n(S)}$$

其中，$$n(A)$$ 表示事件 A 发生的次数，$$n(S)$$ 表示样本空间 S 中所有可能事件的总次数。

### 表示形式

事件 A 发生的概率记作 $$P(A)$$，如果事件 A 不发生，则记作 $$P(\overline{A})$$

事件 A 和 B 同时发生的概率记作 $$P(A \cap B)$$，也可记作 $$P(AB)$$

事件 A 或 B 发生的概率记作 $$P(A \cup B)$$，也可记作 $$P(A + B)$$

事件 A 在事件 B 发生的条件下发生的概率记作 $$P(A|B)$$

## 概率公式

概率公式只是为了方便整理我们的思路，更专业地写解题过程。这里主要分析三个核心公式：

### 条件概率公式

条件概率顾名思义就是在某个条件下计算事件发生的概率。

事件 A 在事件 B 发生的条件下发生的概率记作 $$P(A|B)$$，其计算公式为：$$P(A|B) = \frac{P(A \cap B)}{P(B)}$$

通过概率的计算方法，我们可以将其改写为：$$P(A|B) = \frac{n(A \cap B)}{n(B)}$$

这个表示方法还是不够直观，可以用 venn 图表示如下：

<Image
  src="https://cdn.qladgk.com/images/20250529184839373.png"
  alt="条件概率公式"
  width={666}
  height={527}
  isArticleImage={true}
/>

要研究概率首先要确定样本空间和符合条件的事件。因为 $$P(A|B)$$ 是在事件 B 发生的条件下计算事件 A 的概率，所以样本空间就是 B ，而符合条件的事件就是 A 和 B 的交集

所以 $$P(A|B) = \frac{n(A \cap B)}{n(B)}=\frac{P(A\cap B)}{P(B)}=\frac{P(A \cap B)}{P(B)}$$

我们将这个公式变形可以得到：$$P(A \cap B) = P(A|B)P(B)$$ 即概率的乘法原理，这两个公式本质是不同的，如何理解呢？

<Draft>
  一件事情发生的概率等于造成这件事发生的接连发生的事件概率的乘积，如果要让A，B同时发生，那么就让其中一个先发生，不妨设为
  A 吧，A 发生以后 B 再发生，这样子的话，A，B 就会同时发生
</Draft>

但是你们可能就会疑惑了，印象中的乘法公式不是 $$P(A \cap B) = P(A)P(B)$$吗？为什么这里变成了 $$P(A \cap B) = P(A|B)P(B)$$ 呢？

<Draft>
其实是因为如果事件 A 与 B 相互独立，互不影响，那么 $$P(A|B) = P(A)$$，所以 $$P(A \cap B) = P(A|B)P(B) = P(A)P(B)$$

而平时做的题目中，事件 A 和 B 往往是相互独立的，所以我们经常会用到 $$P(A \cap B) = P(A)P(B)$$ 这个公式

如果事件 A 和 B 不是相互独立的，那么就不能使用 $$P(A \cap B) = P(A)P(B)$$ 这个公式，而是要使用 $$P(A \cap B) = P(A|B)P(B)$$ 这个公式

</Draft>

### 全概率公式

所谓全概率公式就是将“全”部概率 $$P(B)$$ 划分成很多部分的和。理论和实用意义在于：在较复杂的情况下直接算 $$P(B)$$ 不容易，但是 B 总是随着某个 $$A_i$$ 出现，适当去构造这一组 $$A_i$$ 往往可以简化计算

其实就是一个分类讨论的加法原理，上文提到过概率公式只是为了方便整理我们的思路：$$P(B) = \sum_{i=1}^{n} P(A_i)P(B|A_i)$$

比如当 $$n=3$$ 时，$$P(B) = P(A_1)P(B|A_1) + P(A_2)P(B|A_2) + P(A_3)P(B|A_3)$$，而这个式子就是我们分析题目、整理树状图的公式表现，也可以理解成加法原理

<Image
  src="https://cdn.qladgk.com/images/20250529210843928.png"
  alt="全概率公式"
  width={666}
  height={527}
  isArticleImage={true}
/>

<Draft>
  根据上图可知 B 事件可以表示为 $$B=A_1B \cup A_2B \cup A_3B$$，而
  $$A_1B$$、$$A_2B$$、$$A_3B$$ 互不相交，所以 $$P(B) = P(A_1B) + P(A_2B) +
  P(A_3B)$$

而我们知道 $$A_iB$$ 表示两件事情同时发生，所以 $$P(A_iB) = P(A_i)P(B|A_i)$$

则 $$P(B) = P(A_1)P(B|A_1) + P(A_2)P(B|A_2) + P(A_3)P(B|A_3)$$

</Draft>

相信你也注意到了，全概率公式中的一组 $$A_i$$ 需要满足以下条件：

1. 互斥：$$A_i \cap A_j = \emptyset$$，即不同的 $$A_i$$ 之间没有交集
2. 完备：$$A_1 \cup A_2 \cup ... \cup A_n = S$$，即所有的 $$A_i$$ 的并集等于样本空间 S

这样的一组 $$A_i$$ 可以将样本空间 S 划分成互不相交的部分，从而使得全概率公式成立。将 $$A_i$$ 称作完备事件组

### 贝叶斯公式

对于贝叶斯公式，很多人都觉得它很难理解，其实它就是全概率公式的变形，贝叶斯公式的核心思想是通过已知结果去推过程

比如对于一个完备事件组 $$A_1, A_2, ..., A_n$$，我们可以通过全概率公式计算出事件 B 的概率：$$P(B) = \sum_{i=1}^{n} P(A_i)P(B|A_i)$$

那么现在如果问你事件 $$B$$ 属于事件 $$A_i$$ 的概率是多少？或者问你在已知事件 $$B$$ 发生的条件下，事件 $$A_i$$ 发生的概率

<Draft>
  要求的是在已知事件 $$B$$ 发生的条件下，事件 $$A_i$$ 发生的概率，这不就是条件概率的公式吗

所以 $$P(A_i|B) = \frac{P(A_iB)}{P(B)}$$，而 $$P(A_iB) = P(A_i)P(B|A_i)$$，所以 $$P(A_i|B) = \frac{P(A_i)P(B|A_i)}{P(B)}$$

而 $$P(B)$$ 又可以用全概率公式表示为：$$P(B) = \sum_{i=1}^{n} P(A_i)P(B|A_i)$$

</Draft>

所以贝叶斯公式就是：$$P(A_i|B) = \frac{P(A_i)P(B|A_i)}{\sum_{i=1}^{n} P(A_i)P(B|A_i)}$$

## 生物遗传概率题

在一个大型随机交配的种群中，某常染色体隐性遗传病由等位基因 A 和 a 控制，其中 a 是致病等位基因。已知等位基因 a 的频率为 0.02，等位基因 A 的频率为 0.98。基因型 aa 表现为患病，基因型 AA 或 Aa 表现为正常（其中 Aa 为携带者）

### 条件概率应用

随机抽取一个人，已知他不患病（表型正常），求他是携带者（基因型 Aa）的概率

<Draft>
这道题明显要用条件概率：已知不患病，求是携带者的概率

根据题意，事件 A 为不患病，事件 B 为携带者，则所求即是 $$P(B|A)$$

根据条件概率公式：$$P(B|A) = \frac{P(A \cap B)}{P(A)}$$

$$P(A \cap B)$$ 表示同时满足不患病和携带者的概率，也就是 Aa。$$P(A)$$ 表示不患病的概率，也就是 AA 和 Aa 的概率之和

所以 $$P(A \cap B)=P(\text{基因型是 Aa})=2pq=2 \times \frac{49}{50} \times \frac{1}{50} = \frac{98}{2500}$$

$$P(A)=P(\text{基因型是 AA})+P(\text{基因型是 Aa})=p^2+2pq=\frac{49}{50}^2+2 \times \frac{49}{50} \times \frac{1}{50} = \frac{2499}{2500}$$

因此，P(B|A) 的计算为：
$$P(B|A) = \frac{P(A \cap B)}{P(A)} = \frac{98}{2499} = \frac{2}{51}$$

</Draft>

### 全概率公式应用

求患病的概率

<Draft>
设 $$B$$ 为事件“患病”（基因型 aa）。

使用基因型作为完备事件组：设 $$G_1$$ = 基因型 AA，$$G_2$$ = 基因型 Aa，$$G_3$$ = 基因型 aa。这些事件互斥且完备

根据全概率公式，$$P(B) = P(G_1)P(B|G_1) + P(G_2)P(B|G_2) + P(G_3)P(B|G_3)$$

|       完备事件组        | 各基因型概率                                                                    | 条件概率                           |
| :---------------------: | ------------------------------------------------------------------------------- | ---------------------------------- |
| $$G_1$$ （基因型为 AA） | $$P(G_1) = p^2 = \frac{49}{50}^2 = \frac{2401}{2500}$$                          | $$P(B\mid G_1) = 0$$ （AA 不患病） |
| $$G_2$$ （基因型为 Aa） | $$P(G_2) = 2pq = 2 \times \frac{49}{50} \times \frac{1}{50} = \frac{98}{2500}$$ | $$P(B\mid G_2) = 0$$ （Aa 不患病） |
| $$G_3$$ （基因型为 aa） | $$P(G_3) = q^2 = \frac{1}{50}^2 = \frac{1}{2500}$$                              | $$P(B\mid G_3) = 1$$ （aa 患病）   |

所以，$$P(B) = \frac{2401}{2500} \times 0 + \frac{98}{2500} \times 0 + \frac{1}{2500} \times 1 = \frac{1}{2500}$$

</Draft>

### 贝叶斯公式应用

已知患病个体，求父母都是携带者的概率

<Draft>
设 $$C$$ 为事件“孩子患病”（基因型 aa）。
设 $$D$$ 为事件“父母都是携带者”（父母基因型均为 Aa）

则所求为 $$P(D|C)$$，根据贝叶斯公式：$$P(D|C) = \frac{P(D)P(C|D)}{P(C)}$$

先计算 $$P(D)P(C|D)$$，

由于父母都是携带者的概率为 $$P(D) = P(Aa) \times P(Aa) = 2pq \times 2pq = (2 \times \frac{49}{50} \times \frac{1}{50})^2 = \frac{9604}{6250000}$$

$$P(C|D)$$ 表示在父母都是携带者的情况下，孩子患病的概率。根据孟德尔遗传定律，父母都是 Aa 的情况下，孩子患病的概率为 $$P(C|D) = \frac{1}{4}$$

所以，$$P(D)P(C|D) = \frac{9604}{6250000} \times \frac{1}{4} = \frac{2401}{6250000}$$

接下来计算 $$P(C)$$，即孩子患病的概率，$$P(C) = q^2 = \frac{1}{50}^2 = \frac{1}{2500}$$

最后带入贝叶斯公式：$$P(D|C) = \frac{\frac{2401}{6250000}}{\frac{1}{2500}} = \frac{2401}{2500}$$

</Draft>

### 简便方法（配子法）

以上三个小题其实都有简便方法来计算，即生物学的角度，计算过程如下：

<Draft>

1、条件概率题（已知不患病，求是携带者）

**生物学思路**：
表型正常的个体只能由配子组合形成 **AA** 或 **Aa** 基因型。携带者（Aa）在正常个体中的比例，本质是计算 **含 a 等位基因的正常个体占比**。

**配子法步骤**：

1. 正常个体的形成方式：

   - **AA 型**：需雄配子 A + 雌配子 A
   - **Aa 型**：可雄配子 A + 雌配子 a **或** 雄配子 a + 雌配子 A

2. 计算比例：

   - 正常个体总概率 = $$ p^2 $$ (AA) + $$ 2pq $$ (Aa)
   - 携带者 (Aa) 概率 = $$ 2pq $$
   - 所求概率 = $$ \dfrac{\text{Aa 概率}}{\text{正常个体总概率}} = \dfrac{2pq}{p^2 + 2pq} $$

3. 代入数值：
   $$\dfrac{2 \times \dfrac{49}{50} \times \dfrac{1}{50}}{\left( \dfrac{49}{50} \right)^2 + 2 \times \dfrac{49}{50} \times \dfrac{1}{50}} = \dfrac{\dfrac{98}{2500}}{\dfrac{2401}{2500} + \dfrac{98}{2500}} = \dfrac{98}{2401 + 98} = \dfrac{98}{2499} = \dfrac{2}{51}$$

**答案**：$$\dfrac{2}{51}$$

---

2、全概率公式题（求患病概率）

**生物学思路**：  
患病个体基因型为 **aa**，只需两个 a 配子结合。直接利用配子随机结合原理。

**配子法步骤**：

1. 种群中雄配子 a 频率 = $$ q = \dfrac{1}{50} $$
2. 种群中雌配子 a 频率 = $$ q = \dfrac{1}{50} $$
3. 患病概率 = 雄配子 a × 雌配子 a = $$ q \times q = q^2 $$

4. 代入数值：
   $$ \left( \dfrac{1}{50} \right)^2 = \dfrac{1}{2500}$$

**答案**：$$\dfrac{1}{2500}$$

---

3、贝叶斯公式题（已知患病个体，求父母都是携带者）

**生物学思路**：

- 患病孩子基因型为 **aa** ⇒ 必然从父母各继承一个 **a 等位基因**。
- 要求父母均为携带者（Aa），等价于：**在父母各提供一个 a 配子的条件下，父母均非患者（即排除 aa 型）**。

**配子法步骤**：

1. 父母提供 a 配子的概率：

   - 父亲提供 a 配子概率 = $$ P(\text{父亲}a) = q = \dfrac{1}{50} $$
   - 母亲提供 a 配子概率 = $$ P(\text{母亲}a) = q = \dfrac{1}{50} $$

2. **关键简化**：

   - 父亲提供 a 配子时，其基因型可能是 **Aa** 或 **aa**。
   - 父亲是 Aa 的概率（已知提供 a 配子）= $$ \dfrac{P(\text{Aa}) \times P(\text{Aa} \to a)}{P(\text{提供}a)} = \dfrac{2pq \times \frac{1}{2}}{q} = \dfrac{pq}{q} = p $$  
     （分子：Aa 概率 × 提供 a 概率；分母：总提供 a 概率 = q）

3. 因此：

   - 父亲是携带者（Aa）的概率（已知提供 a 配子）= $$ p $$
   - 母亲是携带者（Aa）的概率（已知提供 a 配子）= $$ p $$
   - 父母独立 ⇒ 两者均为携带者的概率 = $$ p \times p = p^2 $$

4. 代入数值：
   $$ \left( \dfrac{49}{50} \right)^2 = \dfrac{2401}{2500}$$

**答案**：$$\dfrac{2401}{2500}$$

</Draft>
